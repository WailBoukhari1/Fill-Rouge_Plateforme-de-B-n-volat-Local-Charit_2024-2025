<!-- Main Container -->
<div class="min-h-screen bg-gray-50 py-4 sm:py-8 px-2 sm:px-4 lg:px-8">
  <div class="max-w-4xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-4 sm:mb-8">
      <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">
        Complete Your Profile
      </h1>
      <p class="text-base sm:text-lg text-gray-600">
        Help us understand you better to match you with the perfect
        opportunities
      </p>
    </div>

    <!-- Progress Bar -->
    <div class="mb-4 sm:mb-8">
      <mat-progress-bar
        mode="determinate"
        [value]="getProgressValue()"
      ></mat-progress-bar>
      <div class="text-center mt-2 text-sm text-gray-600">
        Step {{ currentStep }} of {{ totalSteps }}
      </div>
    </div>

    <!-- Main Form Card -->
    <mat-card class="shadow-lg">
      <mat-card-content class="p-4 sm:p-6">
        <form [formGroup]="questionnaireForm">
          <mat-stepper [linear]="true" #stepper>
            <!-- Step 1: Role Selection -->
            <mat-step
              [stepControl]="roleFormGroup"
              errorMessage="Please select a role"
              [completed]="isRoleFormValid()"
            >
              <ng-template matStepLabel>Select Your Role</ng-template>
              <div [formGroup]="roleFormGroup" class="space-y-4 sm:space-y-6">
                <div class="text-center">
                  <h2
                    class="text-xl sm:text-2xl font-semibold text-gray-900 mb-2"
                  >
                    How would you like to participate?
                  </h2>
                  <p class="text-sm sm:text-base text-gray-600">
                    Choose your role in our community
                  </p>
                </div>

                <mat-radio-group
                  formControlName="type"
                  class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6"
                >
                  <!-- Volunteer Option -->
                  <div
                    class="role-card cursor-pointer rounded-lg border-2 transition-all duration-200 hover:border-indigo-500"
                    [class.selected]="
                      roleFormGroup.get('type')?.value === 'VOLUNTEER'
                    "
                  >
                    <mat-radio-button value="VOLUNTEER" class="w-full">
                      <div class="p-4 sm:p-6 text-center">
                        <div
                          class="w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 rounded-full bg-indigo-100 flex items-center justify-center"
                        >
                          <mat-icon class="text-2xl sm:text-3xl text-indigo-600"
                            >volunteer_activism</mat-icon
                          >
                        </div>
                        <h3
                          class="text-lg sm:text-xl font-medium text-gray-900 mb-2"
                        >
                          Volunteer
                        </h3>
                        <p class="text-sm sm:text-base text-gray-600">
                          Join our community of passionate volunteers making a
                          difference
                        </p>
                        <ul
                          class="mt-3 sm:mt-4 text-left text-xs sm:text-sm text-gray-600 space-y-1.5 sm:space-y-2"
                        >
                          <li class="flex items-center">
                            <mat-icon
                              class="text-green-500 mr-1.5 sm:mr-2 text-xs sm:text-sm"
                              >check_circle</mat-icon
                            >
                            Find opportunities that match your skills
                          </li>
                          <li class="flex items-center">
                            <mat-icon
                              class="text-green-500 mr-1.5 sm:mr-2 text-xs sm:text-sm"
                              >check_circle</mat-icon
                            >
                            Flexible scheduling options
                          </li>
                          <li class="flex items-center">
                            <mat-icon
                              class="text-green-500 mr-1.5 sm:mr-2 text-xs sm:text-sm"
                              >check_circle</mat-icon
                            >
                            Make a real impact in your community
                          </li>
                        </ul>
                      </div>
                    </mat-radio-button>
                  </div>

                  <!-- Organization Option -->
                  <div
                    class="role-card cursor-pointer rounded-lg border-2 transition-all duration-200 hover:border-indigo-500"
                    [class.selected]="
                      roleFormGroup.get('type')?.value === 'ORGANIZATION'
                    "
                  >
                    <mat-radio-button value="ORGANIZATION" class="w-full">
                      <div class="p-4 sm:p-6 text-center">
                        <div
                          class="w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 rounded-full bg-indigo-100 flex items-center justify-center"
                        >
                          <mat-icon class="text-2xl sm:text-3xl text-indigo-600"
                            >business</mat-icon
                          >
                        </div>
                        <h3
                          class="text-lg sm:text-xl font-medium text-gray-900 mb-2"
                        >
                          Organization
                        </h3>
                        <p class="text-sm sm:text-base text-gray-600">
                          Connect with volunteers and expand your impact
                        </p>
                        <ul
                          class="mt-3 sm:mt-4 text-left text-xs sm:text-sm text-gray-600 space-y-1.5 sm:space-y-2"
                        >
                          <li class="flex items-center">
                            <mat-icon
                              class="text-green-500 mr-1.5 sm:mr-2 text-xs sm:text-sm"
                              >check_circle</mat-icon
                            >
                            Post volunteer opportunities
                          </li>
                          <li class="flex items-center">
                            <mat-icon
                              class="text-green-500 mr-1.5 sm:mr-2 text-xs sm:text-sm"
                              >check_circle</mat-icon
                            >
                            Manage volunteers efficiently
                          </li>
                          <li class="flex items-center">
                            <mat-icon
                              class="text-green-500 mr-1.5 sm:mr-2 text-xs sm:text-sm"
                              >check_circle</mat-icon
                            >
                            Track impact and engagement
                          </li>
                        </ul>
                      </div>
                    </mat-radio-button>
                  </div>
                </mat-radio-group>

                <div class="flex justify-end mt-4 sm:mt-6">
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="goToNextStep()"
                    [disabled]="!isRoleFormValid()"
                    class="px-4 sm:px-6 py-2 sm:py-3"
                  >
                    Next <mat-icon class="ml-1 sm:ml-2">arrow_forward</mat-icon>
                  </button>
                </div>
              </div>
            </mat-step>

            <!-- Step 2: Contact Information -->
            <mat-step
              [stepControl]="contactFormGroup"
              errorMessage="Please complete contact information"
              [completed]="isContactFormValid()"
            >
              <ng-template matStepLabel>Contact Information</ng-template>
              <div
                [formGroup]="contactFormGroup"
                class="space-y-4 sm:space-y-6"
              >
                <div class="text-center">
                  <h2
                    class="text-xl sm:text-2xl font-semibold text-gray-900 mb-2"
                  >
                    Contact Information
                  </h2>
                  <p class="text-sm sm:text-base text-gray-600">
                    How can we reach you?
                  </p>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
                  <mat-form-field class="w-full">
                    <mat-label
                      >Phone Number
                      <span class="required-field">*</span></mat-label
                    >
                    <input
                      matInput
                      formControlName="phoneNumber"
                      placeholder="Example: 0612345678"
                    />
                    <mat-icon matPrefix class="mr-2 text-gray-500"
                      >phone</mat-icon
                    >
                    <mat-error
                      *ngIf="
                        contactFormGroup
                          .get('phoneNumber')
                          ?.hasError('required')
                      "
                    >
                      Phone number is required
                    </mat-error>
                    <mat-error
                      *ngIf="
                        contactFormGroup.get('phoneNumber')?.hasError('pattern')
                      "
                    >
                      Please enter a valid Moroccan phone number
                    </mat-error>
                  </mat-form-field>

                  <mat-form-field class="w-full">
                    <mat-label
                      >Address <span class="required-field">*</span></mat-label
                    >
                    <input
                      matInput
                      formControlName="address"
                      placeholder="Your street address"
                    />
                    <mat-icon matPrefix class="mr-2 text-gray-500"
                      >location_on</mat-icon
                    >
                    <mat-error
                      *ngIf="
                        contactFormGroup.get('address')?.hasError('required')
                      "
                    >
                      Address is required
                    </mat-error>
                  </mat-form-field>

                  <mat-form-field class="w-full">
                    <mat-label
                      >Province <span class="required-field">*</span></mat-label
                    >
                    <mat-select
                      formControlName="province"
                      (selectionChange)="onProvinceChange()"
                    >
                      <mat-option
                        *ngFor="let province of moroccanProvinces"
                        [value]="province"
                      >
                        {{ province }}
                      </mat-option>
                    </mat-select>
                    <mat-icon matPrefix class="mr-2 text-gray-500"
                      >public</mat-icon
                    >
                    <mat-error
                      *ngIf="
                        contactFormGroup.get('province')?.hasError('required')
                      "
                    >
                      Province is required
                    </mat-error>
                  </mat-form-field>

                  <mat-form-field class="w-full">
                    <mat-label
                      >City <span class="required-field">*</span></mat-label
                    >
                    <mat-select
                      formControlName="city"
                      [disabled]="
                        isLoadingCities ||
                        !contactFormGroup.get('province')?.value
                      "
                    >
                      <mat-option *ngIf="isLoadingCities">
                        <mat-spinner diameter="20"></mat-spinner>
                        Loading cities...
                      </mat-option>
                      <mat-option
                        *ngIf="
                          !isLoadingCities &&
                          citiesInProvince.length === 0 &&
                          contactFormGroup.get('province')?.value
                        "
                      >
                        No cities available for this province
                      </mat-option>
                      <mat-option
                        *ngFor="let city of citiesInProvince"
                        [value]="city"
                      >
                        {{ city }}
                      </mat-option>
                    </mat-select>
                    <mat-icon matPrefix class="mr-2 text-gray-500"
                      >location_city</mat-icon
                    >
                    <mat-error
                      *ngIf="contactFormGroup.get('city')?.hasError('required')"
                    >
                      City is required
                    </mat-error>
                  </mat-form-field>
                </div>

                <div class="flex justify-between mt-4 sm:mt-6">
                  <button
                    mat-button
                    matStepperPrevious
                    class="px-4 sm:px-6 py-2 sm:py-3"
                  >
                    <mat-icon class="mr-1 sm:mr-2">arrow_back</mat-icon> Back
                  </button>
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="goToNextStep()"
                    [disabled]="!isContactFormValid()"
                    class="px-4 sm:px-6 py-2 sm:py-3"
                  >
                    Next <mat-icon class="ml-1 sm:ml-2">arrow_forward</mat-icon>
                  </button>
                </div>
              </div>
            </mat-step>

            <!-- Step 3: Role-specific Information -->
            <mat-step
              [stepControl]="roleSpecificFormGroup"
              errorMessage="Please complete all required fields"
              [completed]="isRoleSpecificFormValid()"
            >
              <ng-template matStepLabel>Additional Information</ng-template>
              <div [formGroup]="roleSpecificFormGroup">
                <!-- Organization Form -->
                <div *ngIf="isOrganization()" formGroupName="organization" class="space-y-4 sm:space-y-6">
                  <div class="text-center">
                    <h2 class="text-xl sm:text-2xl font-semibold text-gray-900 mb-2">
                      Organization Details
                    </h2>
                    <p class="text-sm sm:text-base text-gray-600">
                      Tell us about your organization
                    </p>
                  </div>

                  <!-- Organization Type -->
                  <mat-form-field class="w-full">
                    <mat-label>Organization Type <span class="required-field">*</span></mat-label>
                    <mat-select formControlName="type" required>
                      <mat-option *ngFor="let type of organizationTypes" [value]="type">
                        {{type | titlecase}}
                      </mat-option>
                    </mat-select>
                    <mat-error *ngIf="roleSpecificFormGroup.get('organization.type')?.hasError('required')">
                      Organization type is required
                    </mat-error>
                  </mat-form-field>

                  <!-- Organization Name -->
                  <mat-form-field class="w-full">
                    <mat-label>Organization Name <span class="required-field">*</span></mat-label>
                    <input matInput formControlName="name" required>
                    <mat-error *ngIf="roleSpecificFormGroup.get('organization.name')?.hasError('required')">
                      Organization name is required
                    </mat-error>
                  </mat-form-field>

                  <!-- Description -->
                  <mat-form-field class="w-full">
                    <mat-label>Description <span class="required-field">*</span></mat-label>
                    <textarea matInput formControlName="description" rows="4" required></textarea>
                    <mat-error *ngIf="roleSpecificFormGroup.get('organization.description')?.hasError('required')">
                      Description is required
                    </mat-error>
                  </mat-form-field>

                  <!-- Mission Statement -->
                  <mat-form-field class="w-full">
                    <mat-label>Mission Statement <span class="required-field">*</span></mat-label>
                    <textarea matInput formControlName="missionStatement" rows="3" required></textarea>
                    <mat-error *ngIf="roleSpecificFormGroup.get('organization.missionStatement')?.hasError('required')">
                      Mission statement is required
                    </mat-error>
                  </mat-form-field>

                  <!-- Focus Areas -->
                  <div class="form-field">
                    <label class="form-label mb-2 block text-sm font-medium text-gray-700">
                      Focus Areas <span class="required-field text-red-500">*</span>
                    </label>
                    <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
                      <div *ngFor="let area of focusAreaOptions" 
                           (click)="toggleFocusArea(area.value)"
                           class="focus-area-item p-3 rounded-lg border-2 cursor-pointer transition-all duration-200"
                           [class.border-indigo-500]="isAreaSelected(area.value)"
                           [class.bg-indigo-50]="isAreaSelected(area.value)"
                           [class.border-gray-200]="!isAreaSelected(area.value)">
                        <div class="flex items-center space-x-2">
                          <mat-icon class="text-indigo-600" [class.opacity-100]="isAreaSelected(area.value)" [class.opacity-40]="!isAreaSelected(area.value)">
                            {{isAreaSelected(area.value) ? 'check_circle' : 'radio_button_unchecked'}}
                          </mat-icon>
                          <span class="text-sm">{{area.label}}</span>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="showFocusAreasError()" class="mt-2 text-sm text-red-600">
                      Please select at least one focus area
                    </div>
                  </div>

                  <!-- Social Media Section -->
                  <div class="mt-6 sm:mt-8">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">
                      Social Media Presence
                    </h3>
                    <div
                      formGroupName="socialMediaLinks"
                      class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6"
                    >
                      <mat-form-field class="w-full">
                        <mat-label>Facebook</mat-label>
                        <input matInput formControlName="facebook" />
                        <mat-error
                          *ngIf="
                            roleSpecificFormGroup
                              .get('organization.socialMediaLinks.facebook')
                              ?.hasError('pattern')
                          "
                        >
                          Please enter a valid Facebook URL
                        </mat-error>
                      </mat-form-field>

                      <mat-form-field class="w-full">
                        <mat-label>Twitter</mat-label>
                        <input matInput formControlName="twitter" />
                        <mat-error
                          *ngIf="
                            roleSpecificFormGroup
                              .get('organization.socialMediaLinks.twitter')
                              ?.hasError('pattern')
                          "
                        >
                          Please enter a valid Twitter URL
                        </mat-error>
                      </mat-form-field>

                      <mat-form-field class="w-full">
                        <mat-label>Instagram</mat-label>
                        <input matInput formControlName="instagram" />
                        <mat-error
                          *ngIf="
                            roleSpecificFormGroup
                              .get('organization.socialMediaLinks.instagram')
                              ?.hasError('pattern')
                          "
                        >
                          Please enter a valid Instagram URL
                        </mat-error>
                      </mat-form-field>

                      <mat-form-field class="w-full">
                        <mat-label>LinkedIn</mat-label>
                        <input matInput formControlName="linkedin" />
                        <mat-error
                          *ngIf="
                            roleSpecificFormGroup
                              .get('organization.socialMediaLinks.linkedin')
                              ?.hasError('pattern')
                          "
                        >
                          Please enter a valid LinkedIn URL
                        </mat-error>
                      </mat-form-field>
                    </div>
                  </div>
                </div>

                <!-- Volunteer Form -->
                <div
                  *ngIf="isVolunteer()"
                  formGroupName="volunteer"
                  class="space-y-4 sm:space-y-6"
                >
                  <div class="text-center">
                    <h2
                      class="text-xl sm:text-2xl font-semibold text-gray-900 mb-2"
                    >
                      Volunteer Details
                    </h2>
                    <p class="text-sm sm:text-base text-gray-600">
                      Tell us about yourself
                    </p>
                  </div>

                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
                    <!-- Bio field with responsive textarea -->
                    <mat-form-field class="w-full sm:col-span-2">
                      <mat-label
                        >Bio <span class="required-field">*</span></mat-label
                      >
                      <textarea
                        matInput
                        formControlName="bio"
                        rows="3"
                        placeholder="Tell us about yourself"
                        class="min-h-[80px] sm:min-h-[100px]"
                      ></textarea>
                      <mat-icon matPrefix class="mr-2 text-gray-500"
                        >person</mat-icon
                      >
                      <mat-error
                        *ngIf="
                          roleSpecificFormGroup
                            .get('volunteer.bio')
                            ?.hasError('required')
                        "
                      >
                        Bio is required
                      </mat-error>
                    </mat-form-field>

                    <!-- Education field with responsive textarea -->
                    <mat-form-field class="w-full sm:col-span-2">
                      <mat-label>Education</mat-label>
                      <textarea
                        matInput
                        formControlName="education"
                        rows="3"
                        placeholder="Your educational background"
                        class="min-h-[80px] sm:min-h-[100px]"
                      ></textarea>
                      <mat-icon matPrefix class="mr-2 text-gray-500"
                        >school</mat-icon
                      >
                    </mat-form-field>

                    <!-- Experience field with responsive textarea -->
                    <mat-form-field class="w-full sm:col-span-2">
                      <mat-label>Experience</mat-label>
                      <textarea
                        matInput
                        formControlName="experience"
                        rows="3"
                        placeholder="Your relevant experience"
                        class="min-h-[80px] sm:min-h-[100px]"
                      ></textarea>
                      <mat-icon matPrefix class="mr-2 text-gray-500"
                        >work</mat-icon
                      >
                    </mat-form-field>

                    <!-- Special Needs field -->
                    <mat-form-field class="w-full sm:col-span-2">
                      <mat-label>Special Needs</mat-label>
                      <input
                        matInput
                        formControlName="specialNeeds"
                        placeholder="Any special requirements or accommodations"
                      />
                      <mat-icon matPrefix class="mr-2 text-gray-500"
                        >accessibility</mat-icon
                      >
                    </mat-form-field>

                    <!-- Skills field with responsive chips -->
                    <mat-form-field class="w-full sm:col-span-2">
                      <mat-label>Skills</mat-label>
                      <mat-chip-grid #chipGrid>
                        <mat-chip-row
                          *ngFor="
                            let skill of roleSpecificFormGroup.get(
                              'volunteer.skills'
                            )?.value
                          "
                          (removed)="removeSkill(skill)"
                        >
                          {{ skill }}
                          <button matChipRemove>
                            <mat-icon>cancel</mat-icon>
                          </button>
                        </mat-chip-row>
                      </mat-chip-grid>
                      <input
                        placeholder="New skill..."
                        [matChipInputFor]="chipGrid"
                        (matChipInputTokenEnd)="addSkill($event)"
                      />
                    </mat-form-field>

                    <!-- Interests field with responsive chips -->
                    <mat-form-field class="w-full sm:col-span-2">
                      <mat-label>Interests</mat-label>
                      <mat-chip-grid #interestGrid>
                        <mat-chip-row
                          *ngFor="
                            let interest of roleSpecificFormGroup.get(
                              'volunteer.interests'
                            )?.value
                          "
                          (removed)="removeInterest(interest)"
                        >
                          {{ interest }}
                          <button matChipRemove>
                            <mat-icon>cancel</mat-icon>
                          </button>
                        </mat-chip-row>
                      </mat-chip-grid>
                      <input
                        placeholder="New interest..."
                        [matChipInputFor]="interestGrid"
                        (matChipInputTokenEnd)="addInterest($event)"
                      />
                    </mat-form-field>

                    <!-- Available Days field with responsive chips -->
                    <mat-form-field class="w-full sm:col-span-2">
                      <mat-label>Available Days</mat-label>
                      <mat-chip-grid #daysGrid>
                        <mat-chip-row
                          *ngFor="
                            let day of roleSpecificFormGroup.get(
                              'volunteer.availableDays'
                            )?.value
                          "
                          (removed)="removeDay(day)"
                        >
                          {{ day }}
                          <button matChipRemove>
                            <mat-icon>cancel</mat-icon>
                          </button>
                        </mat-chip-row>
                      </mat-chip-grid>
                      <input
                        placeholder="New day..."
                        [matChipInputFor]="daysGrid"
                        (matChipInputTokenEnd)="addDay($event)"
                      />
                    </mat-form-field>

                    <!-- Preferred Time of Day field -->
                    <mat-form-field class="w-full">
                      <mat-label>Preferred Time of Day</mat-label>
                      <mat-select formControlName="preferredTimeOfDay">
                        <mat-option value="MORNING">Morning</mat-option>
                        <mat-option value="AFTERNOON">Afternoon</mat-option>
                        <mat-option value="EVENING">Evening</mat-option>
                        <mat-option value="FLEXIBLE">Flexible</mat-option>
                      </mat-select>
                    </mat-form-field>

                    <!-- Languages field with responsive chips -->
                    <mat-form-field class="w-full">
                      <mat-label>Languages</mat-label>
                      <mat-chip-grid #languagesGrid>
                        <mat-chip-row
                          *ngFor="
                            let language of roleSpecificFormGroup.get(
                              'volunteer.languages'
                            )?.value
                          "
                          (removed)="removeLanguage(language)"
                        >
                          {{ language }}
                          <button matChipRemove>
                            <mat-icon>cancel</mat-icon>
                          </button>
                        </mat-chip-row>
                      </mat-chip-grid>
                      <input
                        placeholder="New language..."
                        [matChipInputFor]="languagesGrid"
                        (matChipInputTokenEnd)="addLanguage($event)"
                      />
                    </mat-form-field>

                    <!-- Certifications field with responsive chips -->
                    <mat-form-field class="w-full">
                      <mat-label>Certifications</mat-label>
                      <mat-chip-grid #certificationsGrid>
                        <mat-chip-row
                          *ngFor="
                            let certification of roleSpecificFormGroup.get(
                              'volunteer.certifications'
                            )?.value
                          "
                          (removed)="removeCertification(certification)"
                        >
                          {{ certification }}
                          <button matChipRemove>
                            <mat-icon>cancel</mat-icon>
                          </button>
                        </mat-chip-row>
                      </mat-chip-grid>
                      <input
                        placeholder="New certification..."
                        [matChipInputFor]="certificationsGrid"
                        (matChipInputTokenEnd)="addCertification($event)"
                      />
                    </mat-form-field>

                    <!-- Available for Emergency field -->
                    <div
                      class="w-full sm:col-span-2 bg-gray-50 p-4 rounded-lg border border-gray-200"
                    >
                      <label
                        class="block text-lg font-medium text-gray-900 mb-4"
                      >
                        Available for Emergency Response
                      </label>
                      <mat-radio-group
                        formControlName="availableForEmergency"
                        class="grid grid-cols-2 gap-4"
                      >
                        <div
                          class="relative flex items-center justify-center p-4 rounded-lg cursor-pointer transition-all duration-200"
                          [class.bg-indigo-50]="
                            roleSpecificFormGroup.get(
                              'volunteer.availableForEmergency'
                            )?.value === true
                          "
                          [class.border-indigo-500]="
                            roleSpecificFormGroup.get(
                              'volunteer.availableForEmergency'
                            )?.value === true
                          "
                          [class.border-2]="
                            roleSpecificFormGroup.get(
                              'volunteer.availableForEmergency'
                            )?.value === true
                          "
                          [class.border]="
                            roleSpecificFormGroup.get(
                              'volunteer.availableForEmergency'
                            )?.value !== true
                          "
                          [class.border-gray-200]="
                            roleSpecificFormGroup.get(
                              'volunteer.availableForEmergency'
                            )?.value !== true
                          "
                        >
                          <mat-radio-button [value]="true">
                            <div class="flex items-center space-x-2">
                              <mat-icon class="text-indigo-600"
                                >check_circle</mat-icon
                              >
                              <span class="text-gray-900 font-medium">Yes</span>
                            </div>
                          </mat-radio-button>
                        </div>
                        <div
                          class="relative flex items-center justify-center p-4 rounded-lg cursor-pointer transition-all duration-200"
                          [class.bg-gray-50]="
                            roleSpecificFormGroup.get(
                              'volunteer.availableForEmergency'
                            )?.value === false
                          "
                          [class.border-indigo-500]="
                            roleSpecificFormGroup.get(
                              'volunteer.availableForEmergency'
                            )?.value === false
                          "
                          [class.border-2]="
                            roleSpecificFormGroup.get(
                              'volunteer.availableForEmergency'
                            )?.value === false
                          "
                          [class.border]="
                            roleSpecificFormGroup.get(
                              'volunteer.availableForEmergency'
                            )?.value !== false
                          "
                          [class.border-gray-200]="
                            roleSpecificFormGroup.get(
                              'volunteer.availableForEmergency'
                            )?.value !== false
                          "
                        >
                          <mat-radio-button [value]="false">
                            <div class="flex items-center space-x-2">
                              <mat-icon class="text-gray-600">cancel</mat-icon>
                              <span class="text-gray-900 font-medium">No</span>
                            </div>
                          </mat-radio-button>
                        </div>
                      </mat-radio-group>
                      <p class="mt-2 text-sm text-gray-600">
                        Select 'Yes' if you're willing to be contacted for
                        emergency volunteer opportunities
                      </p>
                    </div>

                    <!-- Emergency Contact Section -->
                    <div
                      *ngIf="
                        roleSpecificFormGroup.get(
                          'volunteer.availableForEmergency'
                        )?.value
                      "
                      class="w-full sm:col-span-2 mt-4 sm:mt-6"
                    >
                      <h3 class="text-lg font-medium text-gray-900 mb-4">
                        Emergency Contact
                      </h3>
                      <div
                        formGroupName="emergencyContact"
                        class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6"
                      >
                        <mat-form-field class="w-full">
                          <mat-label
                            >Name
                            <span class="required-field">*</span></mat-label
                          >
                          <input
                            matInput
                            formControlName="name"
                            placeholder="Emergency contact name"
                          />
                          <mat-icon matPrefix class="mr-2 text-gray-500"
                            >person</mat-icon
                          >
                          <mat-error
                            *ngIf="
                              roleSpecificFormGroup
                                .get('volunteer.emergencyContact.name')
                                ?.hasError('required')
                            "
                          >
                            Emergency contact name is required
                          </mat-error>
                        </mat-form-field>

                        <mat-form-field class="w-full">
                          <mat-label>Relationship</mat-label>
                          <input
                            matInput
                            formControlName="relationship"
                            placeholder="Relationship to you"
                          />
                          <mat-icon matPrefix class="mr-2 text-gray-500"
                            >people</mat-icon
                          >
                        </mat-form-field>

                        <mat-form-field class="w-full">
                          <mat-label
                            >Phone
                            <span class="required-field">*</span></mat-label
                          >
                          <input
                            matInput
                            formControlName="phone"
                            placeholder="Emergency contact phone"
                          />
                          <mat-icon matPrefix class="mr-2 text-gray-500"
                            >phone</mat-icon
                          >
                          <mat-error
                            *ngIf="
                              roleSpecificFormGroup
                                .get('volunteer.emergencyContact.phone')
                                ?.hasError('required')
                            "
                          >
                            Emergency contact phone is required
                          </mat-error>
                          <mat-error
                            *ngIf="
                              roleSpecificFormGroup
                                .get('volunteer.emergencyContact.phone')
                                ?.hasError('pattern')
                            "
                          >
                            Please enter a valid phone number
                          </mat-error>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="flex justify-between mt-6 sm:mt-8">
                  <button
                    mat-button
                    matStepperPrevious
                    class="px-4 sm:px-6 py-2 sm:py-3"
                  >
                    <mat-icon class="mr-1 sm:mr-2">arrow_back</mat-icon> Back
                  </button>
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="onSubmit()"
                    [disabled]="!isRoleSpecificFormValid()"
                    class="px-4 sm:px-6 py-2 sm:py-3"
                  >
                    Submit <mat-icon class="ml-1 sm:ml-2">check</mat-icon>
                  </button>
                </div>
              </div>
            </mat-step>
          </mat-stepper>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>

<style>
.focus-areas-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1rem;
  margin-top: 0.5rem;
}

.focus-area-item {
  display: flex;
  align-items: center;
  padding: 0.75rem;
  border: 1px solid #e2e8f0;
  border-radius: 0.5rem;
  cursor: pointer;
  transition: all 0.2s;
}

.focus-area-item:hover {
  border-color: #6366f1;
  background-color: #f8fafc;
}

.focus-area-item.selected {
  border-color: #6366f1;
  background-color: #eef2ff;
}

.area-icon {
  margin-right: 0.5rem;
  color: #6366f1;
}

.area-label {
  font-size: 0.875rem;
  color: #1f2937;
}

.error-message {
  color: #dc2626;
  font-size: 0.75rem;
  margin-top: 0.25rem;
}
</style>
